pipeline {

    agent {
        label 'slave_1'

    }

    tools {
        maven "M3"
    }

    parameters {
        string(name: 'MAVEN_OPTS', defaultValue: '-Djava.awt.headless=true', description: 'Options for Maven')
    }

    stages {
        stage('Checkout') {
            steps {
                git 'https://github.com/shefeg/DevOps028.git'
            }
        }
		stage('Build') {
			steps {
				echo 'Compiling Project...'
				sh "mvn -B dependency:resolve ${params.MAVEN_OPTS}"
				sh "mvn clean compile -B ${params.MAVEN_OPTS}"
			}
		}
		stage('Test and Package') {
			steps {
				echo 'Testing and Packaging Project..'
				sh "mvn package -B ${params.MAVEN_OPTS}"
			}
		}
		stage('Create Artifact') {
			steps {
			    archive 'target/*.jar'
			}
		}
	}
}